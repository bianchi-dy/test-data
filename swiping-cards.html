<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <title>Swiper demo</title>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"
  />
  <!-- Link Swiper's CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/swiper/swiper-bundle.min.css"
  />
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://d3js.org/d3.v6.js"></script>
</head>

<!-- Demo styles -->
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
  .swiper {
    width: 360px;
    @media only screen and (max-width: 600px) {
      width: 280px;
    }
  }

  .swiper-slide {
    font-family: 'Space Grotesk', sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background-color: #fff;
    color: #38344D;
  }

  .swiper-scenario {
    color: #8B8B8B;
    font-size: 12px;
  }

  .swiper-header{
    font-size: 12px;
  }

  .swiper-text{
    font-size: 16px;
    font-weight: 200;
  }
</style>

<body>
  <!-- Swiper -->
  <button type="button" onclick="highlight('Growth')">Growth</button>
  <button type="button" onclick="highlight('Discipline')">Discipline</button>
  <button type="button" onclick="highlight('Transformation')">Transformation</button>
  <button type="button" onclick="highlight('Collapse')">Collapse</button>
  <div class="swiper mySwiper">
    <div class="swiper-wrapper" id="swiper-container">
    </div>
  </div>

  <!-- Swiper JS -->
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
</body>
<!-- Initialize Swiper -->
<script>
  function generateHTML(obj) {
    let text0 = 
      `<div class="flex justify-center overflow-y-auto ${obj.scenario}" style="max-height: 600px;">
        <div class="block p-6 bg-white max-w-sm">
          <img class="w-full bg-cover" src="https://raw.githubusercontent.com/bianchi-dy/test-data/main/images/${obj.img}">
          <p class="font-light text-right text-sm swiper-scenario mb-4">Image generated by AI at creator.nightcafe.studio</p>
       `;
    
    let text1 = 
        `<div class='mb-4'><span class='py-1 px-2 bg-gray-300 rounded'>${obj.scenario}</span></div>`;

    let text2 = 
      `<div class='mb-4'>
        <p class="swiper-header uppercase font-bold">Job Title</p>
        <p class="swiper-text">${obj.jobtitle}</p>
      </div>
      `;

    let text3 = `<div class='mb-4'>
      <p class="swiper-header uppercase font-bold">What does this job look like?
      </p>`;

    for (let i in obj.jobdesc) {
      let para = obj.jobdesc[i];
      text3 += 
        `<p class="swiper-text mb-2">${para}</p>
        `;
    }

    let text4 = `<div class='mb-4'>
      <p class="swiper-header uppercase font-bold">Why does this job exist?
      </p>`;

    for (let i in obj.jobreason) {
      let para = obj.jobreason[i];
      text4 += 
        `<p class="swiper-text mb-2">${para}</p>
        `;
    }

    let text5 = `<div class='mb-4'>
      <p class="swiper-header uppercase font-bold">Metaphor to describe this future</p>
      <p class="swiper-text pb-4">${obj.jobmetaphor}</p></div>
      `;

    text3 += `</div>`;
    text4 += `</div>`;
    return text0 + text1 + text2 + text3 + text4 + `</div></div>`
  };

  let category = "Discipline";
  
  function createCards(category) {
    var swiper = new Swiper(".mySwiper", {
    effect: "cards",
    keyboard: true,
    grabCursor: true,
    slidesPerView: 1,
    spaceBetween: 30,
    loop: true,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev"
    }
  });

    d3.json("https://raw.githubusercontent.com/bianchi-dy/test-data/main/data/test-data.json").then(function (data, error) {
        for (let i in data['data']) {
          let obj = data['data'][i];
          if (obj.scenario === category || category === undefined) {
            var div = document.createElement('div');
            let html = generateHTML(obj);
            d3.select(".swiper-wrapper").append('div').attr('class', 'swiper-slide shadow-lg').html(html);
          }
        }
      }
    )
  };

  function highlight(cat) {
    category = cat;
    document.getElementById('swiper-container').replaceChildren();
    createCards(cat);
  }

  createCards(category);
  
</script>
